{"ast":null,"code":"import { deleteRecentSearchById, fetchRecentSearches, saveSearchQuery } from \"../utils/searchHandler\";\nconst useSearch = (setMarkers, setAllMarkers, type, setLastSearch, setRecentSearches) => {\n  const fetchPlaces = async (location, selectedType) => {\n    try {\n      const res = await fetch(`/api/places?location=${location.lat},${location.lng}&type=${selectedType}&radius=5000`);\n      const data = await res.json();\n      setMarkers(data.results || []);\n      setAllMarkers(data.results || []);\n      setRecentSearches(await fetchRecentSearches());\n    } catch (error) {\n      console.error(\"❌ Error fetching places:\", error);\n    }\n  };\n  const handleRefetchSearch = async (searchType, location) => {\n    await fetchPlaces({\n      lat: location.coords.lat,\n      lng: location.coords.lng\n    });\n  };\n  const handlePlaceChanged = (searchBox, selectedType, setLastSearchExternal) => {\n    if (!searchBox) return;\n    const place = searchBox.getPlace();\n    if (!place || !place.geometry || !place.geometry.location) return;\n    const location = {\n      lat: place.geometry.location.lat(),\n      lng: place.geometry.location.lng()\n    };\n    const formatted = place.formatted_address;\n    localStorage.setItem(\"lastSearch\", formatted);\n    if (setLastSearchExternal) setLastSearchExternal(formatted);\n    fetchPlaces(location, selectedType); // ✅ Pass in correct type\n  };\n\n  // ✅ Add this function here\n  const deleteRecentSearch = async id => {\n    try {\n      await deleteRecentSearchById(id);\n      const updated = await fetchRecentSearches();\n      setRecentSearches(updated);\n    } catch (err) {\n      console.error(\"❌ Error deleting recent search:\", err);\n    }\n  };\n  const refreshRecentSearches = async () => {\n    try {\n      const updated = await fetchRecentSearches();\n      setRecentSearches(updated);\n    } catch (err) {\n      console.error(\"❌ Failed to refresh recent searches:\", err);\n    }\n  };\n  return {\n    fetchPlaces,\n    handleRefetchSearch,\n    handlePlaceChanged,\n    deleteRecentSearch,\n    refreshRecentSearches // ✅ Expose it from the hook\n  };\n};\nexport default useSearch;","map":{"version":3,"names":["deleteRecentSearchById","fetchRecentSearches","saveSearchQuery","useSearch","setMarkers","setAllMarkers","type","setLastSearch","setRecentSearches","fetchPlaces","location","selectedType","res","fetch","lat","lng","data","json","results","error","console","handleRefetchSearch","searchType","coords","handlePlaceChanged","searchBox","setLastSearchExternal","place","getPlace","geometry","formatted","formatted_address","localStorage","setItem","deleteRecentSearch","id","updated","err","refreshRecentSearches"],"sources":["/home/eashr/pet-resources-app/client/src/hooks/useSearch.jsx"],"sourcesContent":["import { deleteRecentSearchById, fetchRecentSearches, saveSearchQuery } from \"../utils/searchHandler\";\n\nconst useSearch = (\n  setMarkers,\n  setAllMarkers,\n  type,\n  setLastSearch,\n  setRecentSearches\n) => {\n  const fetchPlaces = async (location, selectedType) => {\n    try {\n      const res = await fetch(\n        `/api/places?location=${location.lat},${location.lng}&type=${selectedType}&radius=5000`\n      );\n      const data = await res.json();\n      setMarkers(data.results || []);\n      setAllMarkers(data.results || []);\n      setRecentSearches(await fetchRecentSearches());\n    } catch (error) {\n      console.error(\"❌ Error fetching places:\", error);\n    }\n  };\n  \n\n  const handleRefetchSearch = async (searchType, location) => {\n    await fetchPlaces({ lat: location.coords.lat, lng: location.coords.lng });\n  };\n\n  const handlePlaceChanged = (searchBox, selectedType, setLastSearchExternal) => {\n    if (!searchBox) return;\n    const place = searchBox.getPlace();\n    if (!place || !place.geometry || !place.geometry.location) return;\n  \n    const location = {\n      lat: place.geometry.location.lat(),\n      lng: place.geometry.location.lng(),\n    };\n  \n    const formatted = place.formatted_address;\n    localStorage.setItem(\"lastSearch\", formatted);\n    if (setLastSearchExternal) setLastSearchExternal(formatted);\n    fetchPlaces(location, selectedType); // ✅ Pass in correct type\n  };\n  \n\n  // ✅ Add this function here\n  const deleteRecentSearch = async (id) => {\n    try {\n      await deleteRecentSearchById(id);\n      const updated = await fetchRecentSearches();\n      setRecentSearches(updated);\n    } catch (err) {\n      console.error(\"❌ Error deleting recent search:\", err);\n    }\n  };\n\n  const refreshRecentSearches = async () => {\n    try {\n      const updated = await fetchRecentSearches();\n      setRecentSearches(updated);\n    } catch (err) {\n      console.error(\"❌ Failed to refresh recent searches:\", err);\n    }\n  };\n\n  return {\n    fetchPlaces,\n    handleRefetchSearch,\n    handlePlaceChanged,\n    deleteRecentSearch,\n    refreshRecentSearches // ✅ Expose it from the hook\n  };\n};\n\nexport default useSearch;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}